(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{389:function(e,t,n){var content=n(412);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(19).default)("63c5321a",content,!0,{sourceMap:!1})},411:function(e,t,n){"use strict";n(389)},412:function(e,t,n){var o=n(18)(!1);o.push([e.i,".wrapper[data-v-934b6f04]{width:400px;margin:3rem auto;display:flex;flex-direction:column}.close-btn[data-v-934b6f04]{cursor:pointer;float:right}h1[data-v-934b6f04]{margin:1rem 0}label[data-v-934b6f04]{font-weight:700}input[data-v-934b6f04],label[data-v-934b6f04]{font-size:1rem}input[data-v-934b6f04]{width:100%;padding:.5rem;margin:.5rem 0 1rem}a[data-v-934b6f04]{font-weight:700}p[data-v-934b6f04]{margin:0}.login-btn[data-v-934b6f04],p[data-v-934b6f04]{font-size:1rem}.login-btn[data-v-934b6f04]{background:#ff5140;color:#fff;transition:background .25s ease;border-radius:3px;border:none;padding:.75rem 1rem;text-align:center;font-weight:700;cursor:pointer;width:100%;margin:1rem 0 0}.login-btn[data-v-934b6f04]:focus,.login-btn[data-v-934b6f04]:hover{background:#e61400}.phone-login-btn[data-v-934b6f04]{background:#ff5140;color:#fff;transition:background .25s ease;border-radius:3px;padding:.75rem 1rem;text-align:center;font-weight:700;font-size:1rem;cursor:pointer;background:#fafafa;color:#000;border:1px solid #ff5140;transition:background .25s ease,color .25s ease;width:100%;margin:1rem 0 0}.phone-login-btn[data-v-934b6f04]:focus,.phone-login-btn[data-v-934b6f04]:hover{background:#e61400}.phone-login-btn[data-v-934b6f04]:hover{background:#ff5140;color:#fff}.phone-login-btn[data-v-934b6f04]:focus{border-color:#e61400}.register[data-v-934b6f04]{margin-top:2rem;font-size:1rem;text-align:center}",""]),e.exports=o},442:function(e,t,n){"use strict";n.r(t);n(31),n(24),n(30),n(11),n(36),n(20),n(37);var o=n(9),r=n(15),d=(n(48),n(23));function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={layout:"default-auth",middleware:function(e){var t=e.store,n=e.redirect;t.getters.isLoggedIn&&n("/")},data:function(){return{method:"email",email:"",password:"",phone:"",code:"",isCodeSended:!1}},head:function(){return{title:"Se connecter — eCollectivités"}},methods:l(l({},Object(d.b)(["login","sendVerificationCode","checkVerificationCode"])),{},{loginWithEmail:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.login({method:"email",email:e.email,password:e.password});case 2:!0===t.sent.loggedIn&&window.location.reload();case 4:case"end":return t.stop()}}),t)})))()},loginWithPhone:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isCodeSended){t.next=10;break}return t.next=3,e.checkVerificationCode({phone:e.phone,code:e.code});case 3:return n=t.sent.token,t.next=6,e.login({method:"phone",phone:e.phone,code:e.code,verifyToken:n});case 6:!0===(o=t.sent).loggedIn?window.location.reload():!0===o.expiredPassword&&e.$router.push({path:"/reinitialiser-mdp",query:{email:e.email,redirect:"/connexion"}}),t.next=12;break;case 10:e.sendVerificationCode({phone:e.phone}),e.isCodeSended=!0;case 12:case"end":return t.stop()}}),t)})))()},reSendCode:function(){this.isCodeSended=!1},alreadyHaveCode:function(){this.isCodeSended=!0},changeMethod:function(e){this.method=e}})},v=(n(411),n(8)),component=Object(v.a)(f,(function(){var e=this,t=e._self._c;return t("section",{staticClass:"wrapper"},[t("h1",[e._v("Se connecter")]),e._v(" "),"email"===e.method?t("form",{staticClass:"email-login-form",on:{submit:function(t){return t.preventDefault(),e.loginWithEmail()}}},[t("div",[t("label",{attrs:{for:"email"}},[e._v("Email :")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{id:"email",type:"email",required:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),e._v(" "),t("div",[t("label",{attrs:{for:"password"}},[e._v("Mot de passe :")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{id:"password",type:"password",required:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e._v(" "),t("button",{staticClass:"login-btn",attrs:{type:"submit"}},[e._v("Se connecter")]),e._v(" "),t("button",{staticClass:"phone-login-btn",attrs:{type:"button"},on:{click:function(t){return e.changeMethod("phone")}}},[e._v("\n      Se connecter avec son téléphone\n    ")])]):t("form",{staticClass:"phone-login-form",on:{submit:function(t){return t.preventDefault(),e.loginWithPhone()}}},[t("div",[t("label",{attrs:{for:"phone"}},[e._v("Numéro de téléphone :")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],attrs:{id:"phone",type:"tel",disabled:e.isCodeSended,required:""},domProps:{value:e.phone},on:{input:function(t){t.target.composing||(e.phone=t.target.value)}}})]),e._v(" "),e.isCodeSended?e._e():t("p",[t("a",{on:{click:function(t){return e.alreadyHaveCode()}}},[e._v("J'ai déjà un code")])]),e._v(" "),e.isCodeSended?t("div",[t("div",[t("label",{attrs:{for:"code"}},[e._v("Code de vérification :")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],attrs:{id:"code",required:""},domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}})]),e._v(" "),t("p",[e._v("Pas reçu de code ? "),t("a",{on:{click:function(t){return e.reSendCode()}}},[e._v("Renvoyer")])])]):e._e(),e._v(" "),t("button",{staticClass:"login-btn",attrs:{type:"submit"}},[e._v(e._s(e.isCodeSended?"Vérifier et se connecter":"Continuer"))]),e._v(" "),t("button",{staticClass:"phone-login-btn",attrs:{type:"button"},on:{click:function(t){return e.changeMethod("email")}}},[e._v("Se connecter avec son email")])]),e._v(" "),t("nuxt-link",{staticClass:"register",attrs:{to:"/inscription"}},[e._v("Pas de compte ? S'inscrire")])],1)}),[],!1,null,"934b6f04",null);t.default=component.exports}}]);